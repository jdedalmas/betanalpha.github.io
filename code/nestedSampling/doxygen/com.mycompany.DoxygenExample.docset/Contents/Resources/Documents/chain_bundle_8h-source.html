<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
<title>chainBundle.h Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
<link href="tabs.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.5.7 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li><a href="examples.html"><span>Examples</span></a></li>
    </ul>
  </div>
  <div class="tabs">
    <ul>
      <li><a href="files.html"><span>File&nbsp;List</span></a></li>
    </ul>
  </div>
<h1>chainBundle.h</h1><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 <span class="preprocessor">#ifndef _BETA_CHAIN_BUNDLE_</span>
<a name="l00002"></a>00002 <span class="preprocessor"></span>                                                                      
<a name="l00003"></a>00003 <span class="preprocessor">#include &lt;vector&gt;</span>
<a name="l00004"></a>00004 <span class="preprocessor">#include "baseNestedObject.h"</span>
<a name="l00005"></a>00005 
<a name="l00006"></a>00006 <span class="keyword">class </span>TRandom3;
<a name="l00007"></a>00007 
<a name="l00008"></a>00008 <span class="keyword">using namespace </span>std;
<a name="l00009"></a>00009 
<a name="l00021"></a>00021 
<a name="l00022"></a><a class="code" href="classchain_bundle.html">00022</a> <span class="keyword">class </span><a class="code" href="classchain_bundle.html">chainBundle</a>
<a name="l00023"></a>00023 {
<a name="l00024"></a>00024 
<a name="l00025"></a>00025     <span class="keyword">public</span>:
<a name="l00026"></a>00026     
<a name="l00027"></a>00027         <a class="code" href="classchain_bundle.html#871b9070eac2d3d167fbf46587d0e086">chainBundle</a>(TRandom3 *random);
<a name="l00028"></a>00028         <a class="code" href="classchain_bundle.html#068ff6f9d1960790aeee9e4413435c36">~chainBundle</a>();
<a name="l00029"></a>00029     
<a name="l00030"></a>00030         <span class="comment">// Mutators</span>
<a name="l00031"></a><a class="code" href="classchain_bundle.html#c05520fc8a0b63e71edae4e900110543">00031</a>         <span class="keywordtype">void</span> <a class="code" href="classchain_bundle.html#c05520fc8a0b63e71edae4e900110543" title="Set chainBundle::mGoVerbose.">setVerbosity</a>(<span class="keywordtype">bool</span> v) { <a class="code" href="classchain_bundle.html#938c9f4468453731a7cdb3eef1b990f9" title="Verbosity flag.">mGoVerbose</a> = v; } 
<a name="l00032"></a>00032         
<a name="l00033"></a><a class="code" href="classchain_bundle.html#d64ffcc0477dd78872ea33466a22e04e">00033</a>         <span class="keywordtype">void</span> <a class="code" href="classchain_bundle.html#d64ffcc0477dd78872ea33466a22e04e" title="Set chainBundle::mNumDump.">setNumDump</a>(<span class="keywordtype">int</span> n) { <a class="code" href="classchain_bundle.html#1eb4361ff8bd8bdea69bdd915e93e748" title="Number of HMC steps between each sample.">mNumDump</a> = n; } 
<a name="l00034"></a><a class="code" href="classchain_bundle.html#352340fb9277d248c99c43d702c9360b">00034</a>         <span class="keywordtype">void</span> <a class="code" href="classchain_bundle.html#352340fb9277d248c99c43d702c9360b" title="Set chainBundle::mNumLeapfrog.">setNumLeapfrog</a>(<span class="keywordtype">int</span> n) { <a class="code" href="classchain_bundle.html#db0bef9f1d2fd6e79df0a8616c6076fa" title="Number of leapfrog steps.">mNumLeapfrog</a> = n; } 
<a name="l00035"></a><a class="code" href="classchain_bundle.html#12abcf5bbf597e8bda283213aa56a76b">00035</a>         <span class="keywordtype">void</span> <a class="code" href="classchain_bundle.html#12abcf5bbf597e8bda283213aa56a76b" title="Set chainBundle::mStepSize.">setStepSize</a>(<span class="keywordtype">double</span> s) { <a class="code" href="classchain_bundle.html#3bac4b8b6ef85591457969a3a46d2f3a" title="Nominal leapfrog stepsize.">mStepSize</a> = s; } 
<a name="l00036"></a>00036         <span class="keywordtype">void</span> <a class="code" href="classchain_bundle.html#1560ecc556d2d6c363d9a627fdeb9d51">setStepSizeJitter</a>(<span class="keywordtype">double</span> j); <span class="comment">// Requires warning, see cpp</span>
<a name="l00037"></a><a class="code" href="classchain_bundle.html#75ad97db9082e1d2577252747674a69c">00037</a>         <span class="keywordtype">void</span> <a class="code" href="classchain_bundle.html#75ad97db9082e1d2577252747674a69c" title="Set chainBundle::mMaxStepSize.">setMaxStepSize</a>(<span class="keywordtype">double</span> m) { <a class="code" href="classchain_bundle.html#7fed5db046b01904f671544261baeaec" title="Maximum stepsize allowed for adaptive algorithms.">mMaxStepSize</a> = m; } 
<a name="l00038"></a><a class="code" href="classchain_bundle.html#4724b80d91209a0c714e9a7c063a3b2f">00038</a>         <span class="keywordtype">void</span> <a class="code" href="classchain_bundle.html#4724b80d91209a0c714e9a7c063a3b2f" title="Set chainBundle::mMinStepSize.">setMinStepSize</a>(<span class="keywordtype">double</span> m) { <a class="code" href="classchain_bundle.html#f54b7fd16eab264c7388036617134971" title="Minimum stepsize allowed for adaptive algorithms.">mMinStepSize</a> = m; } 
<a name="l00039"></a><a class="code" href="classchain_bundle.html#3bb07b3b630c5eb7b814f7d6e66eff57">00039</a>         <span class="keywordtype">void</span> <a class="code" href="classchain_bundle.html#3bb07b3b630c5eb7b814f7d6e66eff57" title="Set chainBundle::mTargetAcceptRate.">setTargetAcceptRate</a>(<span class="keywordtype">double</span> r) { <a class="code" href="classchain_bundle.html#4358a10189552f36fa109351af9a1440" title="Desired Metropolis accept rate.">mTargetAcceptRate</a> = r; } 
<a name="l00040"></a><a class="code" href="classchain_bundle.html#29f825dfbe00ced9308f38f040e35474">00040</a>         <span class="keywordtype">void</span> <a class="code" href="classchain_bundle.html#29f825dfbe00ced9308f38f040e35474" title="Set chainBundle::mAlpha.">setAverageDecay</a>(<span class="keywordtype">double</span> alpha) { <a class="code" href="classchain_bundle.html#9ce985a4d4b3396b34ed05b936053784" title="Exponential moving average decay rate.">mAlpha</a> = alpha; } 
<a name="l00041"></a><a class="code" href="classchain_bundle.html#bd8f79979ea13598c5b9dd0cab6bf09e">00041</a>         <span class="keywordtype">void</span> <a class="code" href="classchain_bundle.html#bd8f79979ea13598c5b9dd0cab6bf09e" title="Set chainBundle::mLambda.">setUpdateLambda</a>(<span class="keywordtype">double</span> lambda) { <a class="code" href="classchain_bundle.html#5cf1e5b0a5d1ae6fc4b81017481674e5" title="Stepsize update tempering parameter.">mLambda</a> = lambda; } 
<a name="l00042"></a>00042         
<a name="l00043"></a>00043         <span class="keywordtype">void</span> <a class="code" href="classchain_bundle.html#1b49d1744199c190098f108c2f318fcd">setBurnParameters</a>(<span class="keywordtype">int</span> nBurn, <span class="keywordtype">int</span> nCheck, <span class="keywordtype">double</span> minR);
<a name="l00044"></a>00044             
<a name="l00046"></a><a class="code" href="classchain_bundle.html#f1509af1a5e57ba3c3c9374100d5b9cb">00046</a>         <span class="keywordtype">void</span> <a class="code" href="classchain_bundle.html#f1509af1a5e57ba3c3c9374100d5b9cb" title="Add a new baseNestedObject* to the bundle.">addChain</a>(<a class="code" href="classbase_nested_object.html">baseNestedObject</a> *<span class="keywordtype">object</span>) { <a class="code" href="classchain_bundle.html#5e78a3a7dab8aa59b1a72a533e60c9cf" title="Vector of baseNestedObject pointers.">mChains</a>.push_back(<span class="keywordtype">object</span>); }
<a name="l00047"></a>00047             
<a name="l00048"></a>00048         <span class="comment">// Accesors</span>
<a name="l00049"></a><a class="code" href="classchain_bundle.html#75c9bd6936f2ff3c71bbbc797b3625bd">00049</a>         <span class="keywordtype">int</span> <a class="code" href="classchain_bundle.html#75c9bd6936f2ff3c71bbbc797b3625bd" title="Return chainBundle::mChains::size().">nChains</a>() { <span class="keywordflow">return</span> <a class="code" href="classchain_bundle.html#5e78a3a7dab8aa59b1a72a533e60c9cf" title="Vector of baseNestedObject pointers.">mChains</a>.size(); } 
<a name="l00050"></a><a class="code" href="classchain_bundle.html#0db6ecdbbadbb2a55a5cf221df4f28ff">00050</a>         <a class="code" href="classbase_nested_object.html">baseNestedObject</a>* <a class="code" href="classchain_bundle.html#0db6ecdbbadbb2a55a5cf221df4f28ff" title="Return the ith chain in chainBundle::mChains.">chain</a>(<span class="keywordtype">int</span> i) { <span class="keywordflow">return</span> <a class="code" href="classchain_bundle.html#5e78a3a7dab8aa59b1a72a533e60c9cf" title="Vector of baseNestedObject pointers.">mChains</a>.at(i); } 
<a name="l00051"></a>00051             
<a name="l00052"></a>00052         <span class="comment">// Auxiliary functions</span>
<a name="l00053"></a>00053         <span class="keywordtype">void</span> <a class="code" href="classchain_bundle.html#8b2118912ce0cf418a3e8b8e856495d8" title="Sample all chains.">sample</a>(); 
<a name="l00054"></a>00054         <span class="keywordtype">void</span> <a class="code" href="classchain_bundle.html#8b2118912ce0cf418a3e8b8e856495d8" title="Sample all chains.">sample</a>(<span class="keywordtype">int</span> i); 
<a name="l00055"></a>00055         <span class="keywordtype">void</span> <a class="code" href="classchain_bundle.html#8b2118912ce0cf418a3e8b8e856495d8" title="Sample all chains.">sample</a>(<a class="code" href="classbase_nested_object.html">baseNestedObject</a> *<a class="code" href="classchain_bundle.html#0db6ecdbbadbb2a55a5cf221df4f28ff" title="Return the ith chain in chainBundle::mChains.">chain</a>);
<a name="l00056"></a>00056 
<a name="l00057"></a>00057         <span class="keywordtype">void</span> <a class="code" href="classchain_bundle.html#75cbf2bdfb00f05cd3bac272d949e537" title="Constrained sample all chains.">sampleWithConstraint</a>(); 
<a name="l00058"></a>00058         <span class="keywordtype">void</span> <a class="code" href="classchain_bundle.html#75cbf2bdfb00f05cd3bac272d949e537" title="Constrained sample all chains.">sampleWithConstraint</a>(<span class="keywordtype">int</span> i); 
<a name="l00059"></a>00059         <span class="keywordtype">bool</span> <a class="code" href="classchain_bundle.html#75cbf2bdfb00f05cd3bac272d949e537" title="Constrained sample all chains.">sampleWithConstraint</a>(<a class="code" href="classbase_nested_object.html">baseNestedObject</a> *<a class="code" href="classchain_bundle.html#0db6ecdbbadbb2a55a5cf221df4f28ff" title="Return the ith chain in chainBundle::mChains.">chain</a>);
<a name="l00060"></a>00060         
<a name="l00061"></a>00061         <span class="keywordtype">void</span> <a class="code" href="classchain_bundle.html#7a55b70341a7af52d4c40f422db89504">seed</a>(<span class="keywordtype">double</span> min, <span class="keywordtype">double</span> max);
<a name="l00062"></a>00062         <span class="keywordtype">void</span> <a class="code" href="classchain_bundle.html#7a55b70341a7af52d4c40f422db89504">seed</a>(<span class="keywordtype">int</span> i, <span class="keywordtype">double</span> min, <span class="keywordtype">double</span> max);
<a name="l00063"></a>00063         <span class="keywordtype">void</span> <a class="code" href="classchain_bundle.html#58a5599654900bce805285b315543130">burn</a>();
<a name="l00064"></a>00064         <span class="keywordtype">void</span> <a class="code" href="classchain_bundle.html#f0e96373bf27fdb5ce903b6b3f7ce3a4">burnWithConstraint</a>();
<a name="l00065"></a>00065         
<a name="l00066"></a>00066         <span class="keywordtype">void</span> <a class="code" href="classchain_bundle.html#e43dfa4c6e71a57cc67771336e39eb49">storeBurnedPoints</a>();
<a name="l00067"></a>00067         <span class="keywordtype">void</span> <a class="code" href="classchain_bundle.html#816ce8a98da8846ac19f17e652b0a72a">restoreBurnedPoints</a>();
<a name="l00068"></a>00068 
<a name="l00069"></a>00069     <span class="keyword">protected</span>:
<a name="l00070"></a>00070     
<a name="l00071"></a>00071         <span class="comment">// Flags</span>
<a name="l00072"></a><a class="code" href="classchain_bundle.html#938c9f4468453731a7cdb3eef1b990f9">00072</a>         <span class="keywordtype">bool</span> <a class="code" href="classchain_bundle.html#938c9f4468453731a7cdb3eef1b990f9" title="Verbosity flag.">mGoVerbose</a>; 
<a name="l00073"></a><a class="code" href="classchain_bundle.html#2ee2258623f96681864cda9328aaed9e">00073</a>         <span class="keywordtype">bool</span> <a class="code" href="classchain_bundle.html#2ee2258623f96681864cda9328aaed9e" title="Burn in readiness flag.">mGoBurn</a>; 
<a name="l00074"></a><a class="code" href="classchain_bundle.html#df4a85ef102970e87e2e4d735721ed76">00074</a>         <span class="keywordtype">bool</span> <a class="code" href="classchain_bundle.html#df4a85ef102970e87e2e4d735721ed76" title="Burn in completion flag.">mChar</a>; 
<a name="l00075"></a>00075 
<a name="l00076"></a>00076         <span class="comment">// Random number generator</span>
<a name="l00077"></a><a class="code" href="classchain_bundle.html#2f7fcdf54400dcdbb4c983e67f24f1d3">00077</a>         TRandom3 *<a class="code" href="classchain_bundle.html#2f7fcdf54400dcdbb4c983e67f24f1d3" title="Mersenne twistor pseudo-random number generator.">mRandom</a>; 
<a name="l00078"></a>00078 
<a name="l00079"></a>00079         <span class="comment">// Hamiltonian Monte Carlo parameters</span>
<a name="l00080"></a><a class="code" href="classchain_bundle.html#1eb4361ff8bd8bdea69bdd915e93e748">00080</a>         <span class="keywordtype">int</span> <a class="code" href="classchain_bundle.html#1eb4361ff8bd8bdea69bdd915e93e748" title="Number of HMC steps between each sample.">mNumDump</a>; 
<a name="l00081"></a><a class="code" href="classchain_bundle.html#db0bef9f1d2fd6e79df0a8616c6076fa">00081</a>         <span class="keywordtype">int</span> <a class="code" href="classchain_bundle.html#db0bef9f1d2fd6e79df0a8616c6076fa" title="Number of leapfrog steps.">mNumLeapfrog</a>; 
<a name="l00082"></a><a class="code" href="classchain_bundle.html#3bac4b8b6ef85591457969a3a46d2f3a">00082</a>         <span class="keywordtype">double</span> <a class="code" href="classchain_bundle.html#3bac4b8b6ef85591457969a3a46d2f3a" title="Nominal leapfrog stepsize.">mStepSize</a>; 
<a name="l00083"></a><a class="code" href="classchain_bundle.html#716ca526d35611d9d09fa095bc7f8879">00083</a>         <span class="keywordtype">double</span> <a class="code" href="classchain_bundle.html#716ca526d35611d9d09fa095bc7f8879" title="Stepsize jitter, in fraction of chainBundle::mStepSize.">mStepSizeJitter</a>; 
<a name="l00084"></a><a class="code" href="classchain_bundle.html#7fed5db046b01904f671544261baeaec">00084</a>         <span class="keywordtype">double</span> <a class="code" href="classchain_bundle.html#7fed5db046b01904f671544261baeaec" title="Maximum stepsize allowed for adaptive algorithms.">mMaxStepSize</a>; 
<a name="l00085"></a><a class="code" href="classchain_bundle.html#f54b7fd16eab264c7388036617134971">00085</a>         <span class="keywordtype">double</span> <a class="code" href="classchain_bundle.html#f54b7fd16eab264c7388036617134971" title="Minimum stepsize allowed for adaptive algorithms.">mMinStepSize</a>; 
<a name="l00086"></a>00086         
<a name="l00087"></a><a class="code" href="classchain_bundle.html#1ffd11c8cdb1f37c8418e037c96719b0">00087</a>         <span class="keywordtype">double</span> <a class="code" href="classchain_bundle.html#1ffd11c8cdb1f37c8418e037c96719b0" title="Exponential moving average of Metropolis accept rate.">mXBar</a>; 
<a name="l00088"></a><a class="code" href="classchain_bundle.html#8b8a21710bd60dded35f0f99c27ec275">00088</a>         <span class="keywordtype">double</span> <a class="code" href="classchain_bundle.html#8b8a21710bd60dded35f0f99c27ec275" title="Exponential moving average normalization.">mN</a>; 
<a name="l00089"></a><a class="code" href="classchain_bundle.html#9ce985a4d4b3396b34ed05b936053784">00089</a>         <span class="keywordtype">double</span> <a class="code" href="classchain_bundle.html#9ce985a4d4b3396b34ed05b936053784" title="Exponential moving average decay rate.">mAlpha</a>; 
<a name="l00090"></a>00090 
<a name="l00091"></a><a class="code" href="classchain_bundle.html#4358a10189552f36fa109351af9a1440">00091</a>         <span class="keywordtype">double</span> <a class="code" href="classchain_bundle.html#4358a10189552f36fa109351af9a1440" title="Desired Metropolis accept rate.">mTargetAcceptRate</a>; 
<a name="l00092"></a><a class="code" href="classchain_bundle.html#5cf1e5b0a5d1ae6fc4b81017481674e5">00092</a>         <span class="keywordtype">double</span> <a class="code" href="classchain_bundle.html#5cf1e5b0a5d1ae6fc4b81017481674e5" title="Stepsize update tempering parameter.">mLambda</a>; 
<a name="l00093"></a>00093         
<a name="l00094"></a>00094         <span class="comment">// Burn in parameters</span>
<a name="l00095"></a><a class="code" href="classchain_bundle.html#f17b0acf835f6e37e56ec75f295a592e">00095</a>         <span class="keywordtype">int</span> <a class="code" href="classchain_bundle.html#f17b0acf835f6e37e56ec75f295a592e" title="Number of burn in iterations.">mNumBurn</a>; 
<a name="l00096"></a><a class="code" href="classchain_bundle.html#8b7e1897ba1d724a3ce484da520338ed">00096</a>         <span class="keywordtype">int</span> <a class="code" href="classchain_bundle.html#8b7e1897ba1d724a3ce484da520338ed" title="Number of samples for diagnosing burn in.">mNumCheck</a>; 
<a name="l00097"></a><a class="code" href="classchain_bundle.html#5133ca23614fd9e9232033c495ff8d81">00097</a>         <span class="keywordtype">double</span> <a class="code" href="classchain_bundle.html#5133ca23614fd9e9232033c495ff8d81" title="Minimum R statistic for diagnosing burn in.">mMinR</a>; 
<a name="l00098"></a>00098 
<a name="l00099"></a>00099         <span class="comment">// Chain containers</span>
<a name="l00100"></a><a class="code" href="classchain_bundle.html#5e78a3a7dab8aa59b1a72a533e60c9cf">00100</a>         vector&lt;baseNestedObject*&gt; <a class="code" href="classchain_bundle.html#5e78a3a7dab8aa59b1a72a533e60c9cf" title="Vector of baseNestedObject pointers.">mChains</a>; 
<a name="l00101"></a><a class="code" href="classchain_bundle.html#2ccb8b7638e45b93f2ee96604622cbcf">00101</a>         vector&lt;baseNestedObject*&gt;::iterator <a class="code" href="classchain_bundle.html#2ccb8b7638e45b93f2ee96604622cbcf" title="Vector iterator.">mIt</a>; 
<a name="l00102"></a>00102         
<a name="l00103"></a>00103         <span class="comment">// Private functions</span>
<a name="l00104"></a>00104         
<a name="l00106"></a><a class="code" href="classchain_bundle.html#088bdc01c423f936cda9923874de08fd">00106</a>         <span class="keyword">virtual</span> <span class="keywordtype">bool</span> <a class="code" href="classchain_bundle.html#088bdc01c423f936cda9923874de08fd" title="Abstract method defining interface for likelihood constraint.">fConstraint</a>(<a class="code" href="classbase_nested_object.html">baseNestedObject</a> *<a class="code" href="classchain_bundle.html#0db6ecdbbadbb2a55a5cf221df4f28ff" title="Return the ith chain in chainBundle::mChains.">chain</a>) { <span class="keywordflow">return</span> <span class="keyword">false</span>; }
<a name="l00108"></a><a class="code" href="classchain_bundle.html#18d4baa75bbdf64ada6c7fe50353abcf">00108</a>         <span class="keyword">virtual</span> <span class="keywordtype">double</span>* <a class="code" href="classchain_bundle.html#18d4baa75bbdf64ada6c7fe50353abcf" title="Abstract method defining interface for likelihood constraint normal.">fNormal</a>(<a class="code" href="classbase_nested_object.html">baseNestedObject</a> *<a class="code" href="classchain_bundle.html#0db6ecdbbadbb2a55a5cf221df4f28ff" title="Return the ith chain in chainBundle::mChains.">chain</a>) { <span class="keywordflow">return</span> 0; }
<a name="l00109"></a>00109 
<a name="l00110"></a>00110 };
<a name="l00111"></a>00111 
<a name="l00112"></a>00112 <span class="preprocessor">#define _BETA_CHAIN_BUNDLE_</span>
<a name="l00113"></a>00113 <span class="preprocessor"></span><span class="preprocessor">#endif</span>
</pre></div></div>
<hr size="1"><address style="text-align: right;"><small>Generated on Fri Sep 10 11:09:49 2010 by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.5.7 </small></address>
</body>
</html>
