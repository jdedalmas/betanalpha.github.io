<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
<title>chainBundle.h Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
<link href="tabs.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.5.7 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li><a href="examples.html"><span>Examples</span></a></li>
    </ul>
  </div>
  <div class="tabs">
    <ul>
      <li><a href="files.html"><span>File&nbsp;List</span></a></li>
    </ul>
  </div>
<h1>chainBundle.h</h1><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 <span class="preprocessor">#ifndef _BETA_CHAIN_BUNDLE_</span>
<a name="l00002"></a>00002 <span class="preprocessor"></span>                                                                      
<a name="l00003"></a>00003 <span class="preprocessor">#include &lt;vector&gt;</span>
<a name="l00004"></a>00004 <span class="preprocessor">#include "baseChain.h"</span>
<a name="l00005"></a>00005 
<a name="l00006"></a>00006 <span class="keyword">class </span>TRandom3;
<a name="l00007"></a>00007 
<a name="l00008"></a>00008 <span class="keyword">using namespace </span>std;
<a name="l00009"></a>00009 
<a name="l00019"></a>00019 
<a name="l00020"></a><a class="code" href="classchain_bundle.html">00020</a> <span class="keyword">class </span><a class="code" href="classchain_bundle.html">chainBundle</a>
<a name="l00021"></a>00021 {
<a name="l00022"></a>00022 
<a name="l00023"></a>00023     <span class="keyword">public</span>:
<a name="l00024"></a>00024     
<a name="l00025"></a>00025         <a class="code" href="classchain_bundle.html#871b9070eac2d3d167fbf46587d0e086">chainBundle</a>(TRandom3 *random);
<a name="l00026"></a>00026         <a class="code" href="classchain_bundle.html#068ff6f9d1960790aeee9e4413435c36">~chainBundle</a>();
<a name="l00027"></a>00027     
<a name="l00028"></a>00028         <span class="comment">// Mutators</span>
<a name="l00029"></a><a class="code" href="classchain_bundle.html#c05520fc8a0b63e71edae4e900110543">00029</a>         <span class="keywordtype">void</span> <a class="code" href="classchain_bundle.html#c05520fc8a0b63e71edae4e900110543" title="Set verbosity.">setVerbosity</a>(<span class="keywordtype">bool</span> v) { <a class="code" href="classchain_bundle.html#938c9f4468453731a7cdb3eef1b990f9" title="Verbosity flag.">mGoVerbose</a> = v; }                 
<a name="l00030"></a>00030         
<a name="l00031"></a><a class="code" href="classchain_bundle.html#d64ffcc0477dd78872ea33466a22e04e">00031</a>         <span class="keywordtype">void</span> <a class="code" href="classchain_bundle.html#d64ffcc0477dd78872ea33466a22e04e" title="Set number of HMC iterations per drawn sample.">setNumDump</a>(<span class="keywordtype">int</span> n) { <a class="code" href="classchain_bundle.html#1eb4361ff8bd8bdea69bdd915e93e748" title="Number of HMC steps between each sample.">mNumDump</a> = n; }                      
<a name="l00032"></a><a class="code" href="classchain_bundle.html#352340fb9277d248c99c43d702c9360b">00032</a>         <span class="keywordtype">void</span> <a class="code" href="classchain_bundle.html#352340fb9277d248c99c43d702c9360b" title="Set number of leapfrog steps.">setNumLeapfrog</a>(<span class="keywordtype">int</span> n) { <a class="code" href="classchain_bundle.html#db0bef9f1d2fd6e79df0a8616c6076fa" title="Number of leapfrog steps.">mNumLeapfrog</a> = n; }              
<a name="l00033"></a><a class="code" href="classchain_bundle.html#12abcf5bbf597e8bda283213aa56a76b">00033</a>         <span class="keywordtype">void</span> <a class="code" href="classchain_bundle.html#12abcf5bbf597e8bda283213aa56a76b" title="Set stepsize.">setStepSize</a>(<span class="keywordtype">double</span> s) { <a class="code" href="classchain_bundle.html#3bac4b8b6ef85591457969a3a46d2f3a" title="Nominal leapfrog stepsize.">mStepSize</a> = s; }                 
<a name="l00034"></a>00034         <span class="keywordtype">void</span> <a class="code" href="classchain_bundle.html#1560ecc556d2d6c363d9a627fdeb9d51">setStepSizeJitter</a>(<span class="keywordtype">double</span> j);                             <span class="comment">//   Requires warning, see cpp</span>
<a name="l00035"></a><a class="code" href="classchain_bundle.html#75ad97db9082e1d2577252747674a69c">00035</a>         <span class="keywordtype">void</span> <a class="code" href="classchain_bundle.html#75ad97db9082e1d2577252747674a69c" title="Set maximum stepsize.">setMaxStepSize</a>(<span class="keywordtype">double</span> m) { <a class="code" href="classchain_bundle.html#7fed5db046b01904f671544261baeaec" title="Maximum stepsize allowed for adaptive algorithms.">mMaxStepSize</a> = m; }           
<a name="l00036"></a><a class="code" href="classchain_bundle.html#4724b80d91209a0c714e9a7c063a3b2f">00036</a>         <span class="keywordtype">void</span> <a class="code" href="classchain_bundle.html#4724b80d91209a0c714e9a7c063a3b2f" title="Set minimum stepsize.">setMinStepSize</a>(<span class="keywordtype">double</span> m) { <a class="code" href="classchain_bundle.html#f54b7fd16eab264c7388036617134971" title="Minimum stepsize allowed for adaptive algorithms.">mMinStepSize</a> = m; }           
<a name="l00037"></a><a class="code" href="classchain_bundle.html#3bb07b3b630c5eb7b814f7d6e66eff57">00037</a>         <span class="keywordtype">void</span> <a class="code" href="classchain_bundle.html#3bb07b3b630c5eb7b814f7d6e66eff57" title="Set target accept rate.">setTargetAcceptRate</a>(<span class="keywordtype">double</span> r) { <a class="code" href="classchain_bundle.html#4358a10189552f36fa109351af9a1440" title="Desired Metropolis accept rate.">mTargetAcceptRate</a> = r; } 
<a name="l00038"></a><a class="code" href="classchain_bundle.html#29f825dfbe00ced9308f38f040e35474">00038</a>         <span class="keywordtype">void</span> <a class="code" href="classchain_bundle.html#29f825dfbe00ced9308f38f040e35474" title="Set moving average decay rate.">setAverageDecay</a>(<span class="keywordtype">double</span> alpha) { <a class="code" href="classchain_bundle.html#9ce985a4d4b3396b34ed05b936053784" title="Exponential moving average decay rate.">mAlpha</a> = alpha; }        
<a name="l00039"></a><a class="code" href="classchain_bundle.html#bd8f79979ea13598c5b9dd0cab6bf09e">00039</a>         <span class="keywordtype">void</span> <a class="code" href="classchain_bundle.html#bd8f79979ea13598c5b9dd0cab6bf09e" title="Set stepsize update temperating parameter.">setUpdateLambda</a>(<span class="keywordtype">double</span> lambda) { <a class="code" href="classchain_bundle.html#5cf1e5b0a5d1ae6fc4b81017481674e5" title="Stepsize update tempering parameter.">mLambda</a> = lambda; }     
<a name="l00040"></a><a class="code" href="classchain_bundle.html#72f077bc6ac7b05150c11e61aef5aa83">00040</a>         <span class="keywordtype">void</span> <a class="code" href="classchain_bundle.html#72f077bc6ac7b05150c11e61aef5aa83" title="Set stepsize adaptation flag.">setAdaptStepSize</a>(<span class="keywordtype">bool</span> adapt) { <a class="code" href="classchain_bundle.html#2dd7afa2e420b68364cd4b5cdcece0cd" title="Stepsize adaptation flag.">mAdaptStepSize</a> = adapt; } 
<a name="l00041"></a>00041         
<a name="l00042"></a>00042         <span class="keywordtype">void</span> <a class="code" href="classchain_bundle.html#1b49d1744199c190098f108c2f318fcd">setBurnParameters</a>(<span class="keywordtype">int</span> nBurn, <span class="keywordtype">int</span> nCheck, <span class="keywordtype">double</span> minR);
<a name="l00043"></a>00043             
<a name="l00045"></a><a class="code" href="classchain_bundle.html#fb3fca3ef9899725dce2ada2dd6ee073">00045</a>         <span class="keywordtype">void</span> <a class="code" href="classchain_bundle.html#fb3fca3ef9899725dce2ada2dd6ee073" title="Add a new baseChain* to the bundle.">addChain</a>(<a class="code" href="classbase_chain.html">baseChain</a> *<span class="keywordtype">object</span>) { <a class="code" href="classchain_bundle.html#9ca849bc89326176ffd13419e6849280" title="Vector of baseChain pointers.">mChains</a>.push_back(<span class="keywordtype">object</span>); }
<a name="l00046"></a>00046             
<a name="l00047"></a>00047         <span class="comment">// Accesors</span>
<a name="l00048"></a><a class="code" href="classchain_bundle.html#75c9bd6936f2ff3c71bbbc797b3625bd">00048</a>         <span class="keywordtype">int</span> <a class="code" href="classchain_bundle.html#75c9bd6936f2ff3c71bbbc797b3625bd" title="Return number of chains.">nChains</a>() { <span class="keywordflow">return</span> <a class="code" href="classchain_bundle.html#9ca849bc89326176ffd13419e6849280" title="Vector of baseChain pointers.">mChains</a>.size(); }          
<a name="l00049"></a><a class="code" href="classchain_bundle.html#65ec0280ecc5477b8056a2dee76f6fcf">00049</a>         <a class="code" href="classbase_chain.html">baseChain</a>* <a class="code" href="classchain_bundle.html#65ec0280ecc5477b8056a2dee76f6fcf" title="Return pointer to ith chain.">chain</a>(<span class="keywordtype">int</span> i) { <span class="keywordflow">return</span> <a class="code" href="classchain_bundle.html#9ca849bc89326176ffd13419e6849280" title="Vector of baseChain pointers.">mChains</a>.at(i); } 
<a name="l00050"></a>00050             
<a name="l00051"></a>00051         <span class="comment">// Auxiliary functions</span>
<a name="l00052"></a>00052         <span class="keywordtype">void</span> <a class="code" href="classchain_bundle.html#8b2118912ce0cf418a3e8b8e856495d8" title="Sample all chains.">sample</a>();
<a name="l00053"></a>00053         <span class="keywordtype">void</span> <a class="code" href="classchain_bundle.html#8b2118912ce0cf418a3e8b8e856495d8" title="Sample all chains.">sample</a>(<span class="keywordtype">int</span> i);
<a name="l00054"></a>00054         <span class="keywordtype">bool</span> <a class="code" href="classchain_bundle.html#8b2118912ce0cf418a3e8b8e856495d8" title="Sample all chains.">sample</a>(<a class="code" href="classbase_chain.html">baseChain</a> *<a class="code" href="classchain_bundle.html#65ec0280ecc5477b8056a2dee76f6fcf" title="Return pointer to ith chain.">chain</a>);
<a name="l00055"></a>00055         
<a name="l00056"></a>00056         <span class="keywordtype">void</span> <a class="code" href="classchain_bundle.html#7a55b70341a7af52d4c40f422db89504">seed</a>(<span class="keywordtype">double</span> min, <span class="keywordtype">double</span> max);
<a name="l00057"></a>00057         <span class="keywordtype">void</span> <a class="code" href="classchain_bundle.html#7a55b70341a7af52d4c40f422db89504">seed</a>(<span class="keywordtype">int</span> i, <span class="keywordtype">double</span> min, <span class="keywordtype">double</span> max);
<a name="l00058"></a>00058         <span class="keywordtype">void</span> <a class="code" href="classchain_bundle.html#58a5599654900bce805285b315543130">burn</a>();
<a name="l00059"></a>00059         
<a name="l00060"></a>00060         <span class="keywordtype">void</span> <a class="code" href="classchain_bundle.html#e43dfa4c6e71a57cc67771336e39eb49">storeBurnedPoints</a>();
<a name="l00061"></a>00061         <span class="keywordtype">void</span> <a class="code" href="classchain_bundle.html#816ce8a98da8846ac19f17e652b0a72a">restoreBurnedPoints</a>();
<a name="l00062"></a>00062 
<a name="l00063"></a>00063     <span class="keyword">protected</span>:
<a name="l00064"></a>00064     
<a name="l00065"></a>00065         <span class="comment">// Flags</span>
<a name="l00066"></a><a class="code" href="classchain_bundle.html#938c9f4468453731a7cdb3eef1b990f9">00066</a>         <span class="keywordtype">bool</span> <a class="code" href="classchain_bundle.html#938c9f4468453731a7cdb3eef1b990f9" title="Verbosity flag.">mGoVerbose</a>;          
<a name="l00067"></a><a class="code" href="classchain_bundle.html#2ee2258623f96681864cda9328aaed9e">00067</a>         <span class="keywordtype">bool</span> <a class="code" href="classchain_bundle.html#2ee2258623f96681864cda9328aaed9e" title="Burn in readiness flag.">mGoBurn</a>;             
<a name="l00068"></a><a class="code" href="classchain_bundle.html#df4a85ef102970e87e2e4d735721ed76">00068</a>         <span class="keywordtype">bool</span> <a class="code" href="classchain_bundle.html#df4a85ef102970e87e2e4d735721ed76" title="Burn in completion flag.">mChar</a>;               
<a name="l00069"></a>00069 
<a name="l00070"></a>00070         <span class="comment">// Random number generator</span>
<a name="l00071"></a><a class="code" href="classchain_bundle.html#2f7fcdf54400dcdbb4c983e67f24f1d3">00071</a>         TRandom3 *<a class="code" href="classchain_bundle.html#2f7fcdf54400dcdbb4c983e67f24f1d3" title="Mersenne twistor pseudo-random number generator.">mRandom</a>;        
<a name="l00072"></a>00072 
<a name="l00073"></a>00073         <span class="comment">// Hamiltonian Monte Carlo parameters</span>
<a name="l00074"></a><a class="code" href="classchain_bundle.html#1eb4361ff8bd8bdea69bdd915e93e748">00074</a>         <span class="keywordtype">int</span> <a class="code" href="classchain_bundle.html#1eb4361ff8bd8bdea69bdd915e93e748" title="Number of HMC steps between each sample.">mNumDump</a>;             
<a name="l00075"></a><a class="code" href="classchain_bundle.html#db0bef9f1d2fd6e79df0a8616c6076fa">00075</a>         <span class="keywordtype">int</span> <a class="code" href="classchain_bundle.html#db0bef9f1d2fd6e79df0a8616c6076fa" title="Number of leapfrog steps.">mNumLeapfrog</a>;         
<a name="l00076"></a><a class="code" href="classchain_bundle.html#3bac4b8b6ef85591457969a3a46d2f3a">00076</a>         <span class="keywordtype">double</span> <a class="code" href="classchain_bundle.html#3bac4b8b6ef85591457969a3a46d2f3a" title="Nominal leapfrog stepsize.">mStepSize</a>;         
<a name="l00077"></a><a class="code" href="classchain_bundle.html#716ca526d35611d9d09fa095bc7f8879">00077</a>         <span class="keywordtype">double</span> <a class="code" href="classchain_bundle.html#716ca526d35611d9d09fa095bc7f8879" title="Stepsize jitter, in fraction of chainBundle::mStepSize.">mStepSizeJitter</a>;   
<a name="l00078"></a><a class="code" href="classchain_bundle.html#7fed5db046b01904f671544261baeaec">00078</a>         <span class="keywordtype">double</span> <a class="code" href="classchain_bundle.html#7fed5db046b01904f671544261baeaec" title="Maximum stepsize allowed for adaptive algorithms.">mMaxStepSize</a>;      
<a name="l00079"></a><a class="code" href="classchain_bundle.html#f54b7fd16eab264c7388036617134971">00079</a>         <span class="keywordtype">double</span> <a class="code" href="classchain_bundle.html#f54b7fd16eab264c7388036617134971" title="Minimum stepsize allowed for adaptive algorithms.">mMinStepSize</a>;      
<a name="l00080"></a>00080         
<a name="l00081"></a><a class="code" href="classchain_bundle.html#1ffd11c8cdb1f37c8418e037c96719b0">00081</a>         <span class="keywordtype">double</span> <a class="code" href="classchain_bundle.html#1ffd11c8cdb1f37c8418e037c96719b0" title="Exponential moving average of Metropolis accept rate.">mXBar</a>;             
<a name="l00082"></a><a class="code" href="classchain_bundle.html#8b8a21710bd60dded35f0f99c27ec275">00082</a>         <span class="keywordtype">double</span> <a class="code" href="classchain_bundle.html#8b8a21710bd60dded35f0f99c27ec275" title="Exponential moving average normalization.">mN</a>;                
<a name="l00083"></a><a class="code" href="classchain_bundle.html#9ce985a4d4b3396b34ed05b936053784">00083</a>         <span class="keywordtype">double</span> <a class="code" href="classchain_bundle.html#9ce985a4d4b3396b34ed05b936053784" title="Exponential moving average decay rate.">mAlpha</a>;            
<a name="l00084"></a>00084 
<a name="l00085"></a><a class="code" href="classchain_bundle.html#2dd7afa2e420b68364cd4b5cdcece0cd">00085</a>         <span class="keywordtype">bool</span> <a class="code" href="classchain_bundle.html#2dd7afa2e420b68364cd4b5cdcece0cd" title="Stepsize adaptation flag.">mAdaptStepSize</a>;      
<a name="l00086"></a><a class="code" href="classchain_bundle.html#4358a10189552f36fa109351af9a1440">00086</a>         <span class="keywordtype">double</span> <a class="code" href="classchain_bundle.html#4358a10189552f36fa109351af9a1440" title="Desired Metropolis accept rate.">mTargetAcceptRate</a>; 
<a name="l00087"></a><a class="code" href="classchain_bundle.html#5cf1e5b0a5d1ae6fc4b81017481674e5">00087</a>         <span class="keywordtype">double</span> <a class="code" href="classchain_bundle.html#5cf1e5b0a5d1ae6fc4b81017481674e5" title="Stepsize update tempering parameter.">mLambda</a>;           
<a name="l00088"></a>00088         
<a name="l00089"></a><a class="code" href="classchain_bundle.html#a99447da8e473e1d5bd953cf0f3ac60d">00089</a>         <span class="keywordtype">int</span> <a class="code" href="classchain_bundle.html#a99447da8e473e1d5bd953cf0f3ac60d" title="Total number of computed samples.">mNumSamples</a>;          
<a name="l00090"></a>00090         
<a name="l00091"></a>00091         <span class="comment">// Burn in parameters</span>
<a name="l00092"></a><a class="code" href="classchain_bundle.html#f17b0acf835f6e37e56ec75f295a592e">00092</a>         <span class="keywordtype">int</span> <a class="code" href="classchain_bundle.html#f17b0acf835f6e37e56ec75f295a592e" title="Number of burn in iterations.">mNumBurn</a>;             
<a name="l00093"></a><a class="code" href="classchain_bundle.html#8b7e1897ba1d724a3ce484da520338ed">00093</a>         <span class="keywordtype">int</span> <a class="code" href="classchain_bundle.html#8b7e1897ba1d724a3ce484da520338ed" title="Number of samples for diagnosing burn in.">mNumCheck</a>;            
<a name="l00094"></a><a class="code" href="classchain_bundle.html#5133ca23614fd9e9232033c495ff8d81">00094</a>         <span class="keywordtype">double</span> <a class="code" href="classchain_bundle.html#5133ca23614fd9e9232033c495ff8d81" title="Minimum R statistic for diagnosing burn in.">mMinR</a>;             
<a name="l00095"></a>00095 
<a name="l00096"></a>00096         <span class="comment">// Chain containers</span>
<a name="l00097"></a><a class="code" href="classchain_bundle.html#9ca849bc89326176ffd13419e6849280">00097</a>         vector&lt;baseChain*&gt; <a class="code" href="classchain_bundle.html#9ca849bc89326176ffd13419e6849280" title="Vector of baseChain pointers.">mChains</a>;       
<a name="l00098"></a><a class="code" href="classchain_bundle.html#fcfa15dbb5b59ac728319ba5ffa5008c">00098</a>         vector&lt;baseChain*&gt;::iterator <a class="code" href="classchain_bundle.html#fcfa15dbb5b59ac728319ba5ffa5008c" title="Vector iterator.">mIt</a>; 
<a name="l00099"></a>00099         
<a name="l00100"></a>00100         <span class="comment">// Private functions</span>
<a name="l00101"></a>00101         
<a name="l00104"></a><a class="code" href="classchain_bundle.html#322d123bdd3e0fa07dd617ccd6dbb5ae">00104</a>         <span class="keyword">virtual</span> <span class="keywordtype">bool</span> <a class="code" href="classchain_bundle.html#322d123bdd3e0fa07dd617ccd6dbb5ae">fConstraint</a>(<a class="code" href="classbase_chain.html">baseChain</a> *<a class="code" href="classchain_bundle.html#65ec0280ecc5477b8056a2dee76f6fcf" title="Return pointer to ith chain.">chain</a>) { <span class="keywordflow">return</span> !(chain-&gt;<a class="code" href="classbase_chain.html#5c3e7e2b6cf79cb2225502a31572c961" title="Virtual method defining the interface for checking violation of valid support.">supportViolated</a>()); }
<a name="l00105"></a>00105         
<a name="l00108"></a><a class="code" href="classchain_bundle.html#f18b9fd60d9e7c1085f25bb87c7dc3c9">00108</a>         <span class="keyword">virtual</span> <span class="keywordtype">double</span>* <a class="code" href="classchain_bundle.html#f18b9fd60d9e7c1085f25bb87c7dc3c9">fNormal</a>(<a class="code" href="classbase_chain.html">baseChain</a> *<a class="code" href="classchain_bundle.html#65ec0280ecc5477b8056a2dee76f6fcf" title="Return pointer to ith chain.">chain</a>) { <span class="keywordflow">return</span> chain-&gt;<a class="code" href="classbase_chain.html#4a7767bc68eb2f32a579477ba0929cb1">supportNormal</a>(); }
<a name="l00109"></a>00109 
<a name="l00110"></a>00110 };
<a name="l00111"></a>00111 
<a name="l00112"></a>00112 <span class="preprocessor">#define _BETA_CHAIN_BUNDLE_</span>
<a name="l00113"></a>00113 <span class="preprocessor"></span><span class="preprocessor">#endif</span>
</pre></div></div>
<hr size="1"><address style="text-align: right;"><small>Generated on Wed Apr 6 18:49:00 2011 by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.5.7 </small></address>
</body>
</html>
